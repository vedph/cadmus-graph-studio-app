{
  "namedMappings": {
    "event_note": {
      "name": "event/note",
      "description": "Map the note of an event to EVENT crm:P3_has_note LITERAL.",
      "source": "note",
      "sid": "{$id}/note",
      "output": {
        "triples": ["{?event} crm:P3_has_note \"{$.}\""]
      }
    },
    "event_chronotope": {
      "name": "event/chronotope",
      "description": "Map the place/date of an event to triples which create a place node for the place and link it to the event via a triple using crm:P7_took_place_at for places; and to triples using crm:P4_has_time_span which in turn has a new timespan node has object.",
      "source": "chronotope",
      "sid": "{$id}/chronotope",
      "children": [
        {
          "name": "event/chronotope/place",
          "source": "place",
          "output": {
            "nodes": {
              "place": "itn:places/{@value}"
            },
            "triples": [
              "{?place} a crm:E53_Place",
              "{?event} crm:P7_took_place_at {?place}"
            ]
          }
        },
        {
          "name": "event/chronotope/date",
          "source": "date",
          "output": {
            "metadata": {
              "date_value": "{!_hdate({@.} & value)}",
              "date_text": "{!_hdate({@.} & text)}"
            },
            "nodes": {
              "timespan": "itn:timespans/ts"
            },
            "triples": [
              "{?event} crm:P4_has_time_span {?timespan}",
              "{?timespan} crm:P82_at_some_time_within \"{$date_value}\"^^xs:float",
              "{?timespan} crm:P87_is_identified_by \"{$date_text}\"@en"
            ]
          }
        }
      ]
    }
  },
  "documentMappings": [
    {
      "name": "work",
      "sourceType": 2,
      "facetFilter": "work",
      "partTypeFilter": "it.vedph.metadata",
      "description": "Map a work item to a node via the item's EID extracted from its MetadataPart.",
      "source": "metadata[?name=='eid']",
      "sid": "{$part-id}/{@[0].value}",
      "output": {
        "nodes": {
          "work": "itn:works/{$item-id}/{@value} itn:works/{@value}"
        },
        "triples": ["{?work} a E90_symbolic_object"]
      }
    },
    {
      "name": "text sent event",
      "sourceType": 2,
      "facetFilter": "work",
      "partTypeFilter": "it.vedph.historical-events",
      "description": "Map text sent event",
      "source": "events[?type=='text.send']",
      "sid": "{$part-id}/{@[0].eid}",
      "output": {
        "metadata": {
          "id": "{$part-id}/{@eid}",
          "work": "itn:works/{$item-id}/{$item-eid}"
        },
        "nodes": {
          "event": "itn:events/{$id} itn:events/{@eid}"
        },
        "triples": [
          "{?event} a crm:E7_Activity",
          "{?event} crm:P2_has_type itn:event-types/text.send",
          "{?event} crm:P16_used_specific_object {$work}"
        ]
      },
      "children": [
        {
          "name": "event_note"
        },
        {
          "name": "event_chronotope"
        },
        {
          "name": "text sent event/related/carried_out_by",
          "source": "relatedEntities[?relation=='text:send:sender']",
          "output": {
            "nodes": {
              "sender": "{@id}"
            },
            "triples": ["{?event} crm:P14_carried_out_by {?sender}"]
          }
        },
        {
          "name": "text sent event/related/has_participant",
          "source": "relatedEntities[?relation=='text:send:recipient']",
          "output": {
            "nodes": {
              "recipient": "{@id}"
            },
            "triples": ["{?event} crm:P11_has_participant {?recipient}"]
          }
        },
        {
          "name": "text sent event/related/has_participant",
          "source": "relatedEntities[?relation=='text:send:carrier']",
          "output": {
            "nodes": {
              "carrier": "{@id}"
            },
            "triples": ["{?event} crm:P11_has_participant {?carrier}"]
          }
        }
      ]
    }
  ]
}
