<form [formGroup]="form" (submit)="transform()">
  <div id="container">
    <!-- jmes -->
    <div id="expr">
      <mat-form-field class="long-text">
        <mat-label>jmes</mat-label>
        <input matInput [formControl]="jmes" />
        <mat-error
          *ngIf="$any(jmes).errors?.required && (jmes.dirty || jmes.touched)"
          >JMES required</mat-error
        >
        <mat-error
          *ngIf="$any(jmes).errors?.maxLength && (jmes.dirty || jmes.touched)"
          >JMES too long</mat-error
        >
        <mat-error *ngIf="error">{{ error }}</mat-error>
      </mat-form-field>
      <button
        type="submit"
        mat-icon-button
        color="primary"
        [disabled]="form.invalid || busy"
        matTooltip="Run JMES"
      >
        <mat-icon>play_circle</mat-icon>
      </button>
    </div>

    <!-- input -->
    <div id="input">
      <div>
        <mat-label>input</mat-label>
        <ngx-monaco-editor
          [options]="editorOptions"
          [formControl]="input"
        ></ngx-monaco-editor>
        <mat-error
          *ngIf="$any(input).errors?.required && (input.dirty || input.touched)"
          >input required</mat-error
        >
        <mat-error
          *ngIf="
            $any(input).errors?.maxLength && (input.dirty || input.touched)
          "
          >input too long</mat-error
        >
      </div>
      <!-- presets -->
      <fieldset>
        <legend>presets</legend>
        <cadmus-cached-text-picker
          [text]="input.value"
          (textPick)="onTextPick($event)"
          cacheKey="jmes"
        ></cadmus-cached-text-picker>
      </fieldset>
    </div>

    <!-- output -->
    <div id="output">
      <mat-label>output</mat-label>
      <ngx-monaco-editor
        [options]="editorOptions"
        [formControl]="output"
      ></ngx-monaco-editor>
    </div>
  </div>
</form>
